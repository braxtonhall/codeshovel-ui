{
	"repo": "https://github.com/elastic/elasticsearch.git",
	"file": "server/src/main/java/org/elasticsearch/bootstrap/Security.java",
	"method": {
		"longName": "Permissions createPermissions(Environment environment);",
		"startLine": 249,
		"methodName": "createPermissions",
		"isStatic": true,
		"isAbstract": false,
		"visibility": ""
	},
	"history": {
		"99f88f15c5febbca2d13b5b5fda27b844153bf1a": {
			"type": "Yfilerename",
			"commitMessage": "Rename core module to server (#28180)\n\nThis is related to #27933. It renames the core module to server. This is\r\nthe first step towards introducing an elasticsearch-core jar.",
			"commitDate": "2018-01-11, 10:30 AM",
			"commitName": "99f88f15c5febbca2d13b5b5fda27b844153bf1a",
			"commitAuthor": "Tim Brooks",
			"commitDateOld": "2018-01-11, 8:31 AM",
			"commitNameOld": "7d0eb3292b8f8ba27ef50dbbf38783dc68c70728",
			"commitAuthorOld": "Martijn van Groningen",
			"daysBetweenCommits": 0.08,
			"commitsBetweenForRepo": 1,
			"commitsBetweenForFile": 1,
			"diff": "",
			"extendedDetails": {
				"oldPath": "core/src/main/java/org/elasticsearch/bootstrap/Security.java",
				"newPath": "server/src/main/java/org/elasticsearch/bootstrap/Security.java"
			}
		},
		"720ebe347d1410bce178e4f244237b9870403b84": {
			"type": "Ybodychange",
			"commitMessage": "Handle system policy correctly.\n\nJust suck in the system policy, so its compatible with any version of java.\nIt means it also respects configuration (e.g. for monitoring agents)\n\nCloses #14704\n",
			"commitDate": "2015-11-12, 3:08 PM",
			"commitName": "720ebe347d1410bce178e4f244237b9870403b84",
			"commitAuthor": "Robert Muir",
			"commitDateOld": "2015-11-07, 9:22 AM",
			"commitNameOld": "e06cae84f3ca9c43ddb1424268bf9a87a429fdc4",
			"commitAuthorOld": "Robert Muir",
			"daysBetweenCommits": 5.24,
			"commitsBetweenForRepo": 83,
			"commitsBetweenForFile": 1,
			"diff": "@@ -1,6 +1,7 @@\n     static Permissions createPermissions(Environment environment) throws IOException {\n         Permissions policy = new Permissions();\n+        addClasspathPermissions(policy);\n         addFilePermissions(policy, environment);\n         addBindPermissions(policy, environment.settings());\n         return policy;\n     }\n\\ No newline at end of file\n",
			"extendedDetails": {}
		},
		"e06cae84f3ca9c43ddb1424268bf9a87a429fdc4": {
			"type": "Ybodychange",
			"commitMessage": "only allow code to bind to the user's configured port numbers/ranges\n\nRandom code shouldn't be listening on sockets elsewhere.\n\nToday its the wild west, but we only need to grant access to what the user configured.\n\nThis means e.g. multicast plugin has to declare its intentions in its security.policy\n\nCloses #14549\n",
			"commitDate": "2015-11-07, 9:22 AM",
			"commitName": "e06cae84f3ca9c43ddb1424268bf9a87a429fdc4",
			"commitAuthor": "Robert Muir",
			"commitDateOld": "2015-10-29, 11:14 AM",
			"commitNameOld": "1194cd0bdc22bc598a936480437951e7b130b1d7",
			"commitAuthorOld": "Robert Muir",
			"daysBetweenCommits": 8.96,
			"commitsBetweenForRepo": 109,
			"commitsBetweenForFile": 1,
			"diff": "@@ -1,29 +1,6 @@\n     static Permissions createPermissions(Environment environment) throws IOException {\n         Permissions policy = new Permissions();\n-        // read-only dirs\n-        addPath(policy, \"path.home\", environment.binFile(), \"read,readlink\");\n-        addPath(policy, \"path.home\", environment.libFile(), \"read,readlink\");\n-        addPath(policy, \"path.plugins\", environment.pluginsFile(), \"read,readlink\");\n-        addPath(policy, \"path.conf\", environment.configFile(), \"read,readlink\");\n-        addPath(policy, \"path.scripts\", environment.scriptsFile(), \"read,readlink\");\n-        // read-write dirs\n-        addPath(policy, \"java.io.tmpdir\", environment.tmpFile(), \"read,readlink,write,delete\");\n-        addPath(policy, \"path.logs\", environment.logsFile(), \"read,readlink,write,delete\");\n-        if (environment.sharedDataFile() != null) {\n-            addPath(policy, \"path.shared_data\", environment.sharedDataFile(), \"read,readlink,write,delete\");\n-        }\n-        for (Path path : environment.dataFiles()) {\n-            addPath(policy, \"path.data\", path, \"read,readlink,write,delete\");\n-        }\n-        for (Path path : environment.dataWithClusterFiles()) {\n-            addPath(policy, \"path.data\", path, \"read,readlink,write,delete\");\n-        }\n-        for (Path path : environment.repoFiles()) {\n-            addPath(policy, \"path.repo\", path, \"read,readlink,write,delete\");\n-        }\n-        if (environment.pidFile() != null) {\n-            // we just need permission to remove the file if its elsewhere.\n-            policy.add(new FilePermission(environment.pidFile().toString(), \"delete\"));\n-        }\n+        addFilePermissions(policy, environment);\n+        addBindPermissions(policy, environment.settings());\n         return policy;\n     }\n\\ No newline at end of file\n",
			"extendedDetails": {}
		},
		"d96af934db7a9ab25e8e76f01a2b5fe4c26f6ec1": {
			"type": "Ybodychange",
			"commitMessage": "Improve startup exceptions (especially file permissions etc)\n\nSquashed commit of the following:\n\ncommit 0014d31c1c478977cc8c50eb635eab0fb91449e4\nAuthor: Robert Muir <rmuir@apache.org>\nDate:   Fri Aug 21 18:20:35 2015 -0400\n\n    Add missing paren to javadocs\n\ncommit bb46142785c67b849cfa5aa08fe5a3877a550b3d\nAuthor: Robert Muir <rmuir@apache.org>\nDate:   Fri Aug 21 18:08:45 2015 -0400\n\n    Improve startup exceptions (especially file permissions etc)\n",
			"commitDate": "2015-08-21, 3:21 PM",
			"commitName": "d96af934db7a9ab25e8e76f01a2b5fe4c26f6ec1",
			"commitAuthor": "Robert Muir",
			"commitDateOld": "2015-08-12, 9:51 AM",
			"commitNameOld": "ff5ad39c7a5f8ea21d3ff86d3ce50668602d7a74",
			"commitAuthorOld": "Lee Hinman",
			"daysBetweenCommits": 9.23,
			"commitsBetweenForRepo": 205,
			"commitsBetweenForFile": 1,
			"diff": "@@ -1,29 +1,29 @@\n     static Permissions createPermissions(Environment environment) throws IOException {\n         Permissions policy = new Permissions();\n         // read-only dirs\n-        addPath(policy, environment.binFile(), \"read,readlink\");\n-        addPath(policy, environment.libFile(), \"read,readlink\");\n-        addPath(policy, environment.pluginsFile(), \"read,readlink\");\n-        addPath(policy, environment.configFile(), \"read,readlink\");\n-        addPath(policy, environment.scriptsFile(), \"read,readlink\");\n+        addPath(policy, \"path.home\", environment.binFile(), \"read,readlink\");\n+        addPath(policy, \"path.home\", environment.libFile(), \"read,readlink\");\n+        addPath(policy, \"path.plugins\", environment.pluginsFile(), \"read,readlink\");\n+        addPath(policy, \"path.conf\", environment.configFile(), \"read,readlink\");\n+        addPath(policy, \"path.scripts\", environment.scriptsFile(), \"read,readlink\");\n         // read-write dirs\n-        addPath(policy, environment.tmpFile(), \"read,readlink,write,delete\");\n-        addPath(policy, environment.logsFile(), \"read,readlink,write,delete\");\n+        addPath(policy, \"java.io.tmpdir\", environment.tmpFile(), \"read,readlink,write,delete\");\n+        addPath(policy, \"path.logs\", environment.logsFile(), \"read,readlink,write,delete\");\n         if (environment.sharedDataFile() != null) {\n-            addPath(policy, environment.sharedDataFile(), \"read,readlink,write,delete\");\n+            addPath(policy, \"path.shared_data\", environment.sharedDataFile(), \"read,readlink,write,delete\");\n         }\n         for (Path path : environment.dataFiles()) {\n-            addPath(policy, path, \"read,readlink,write,delete\");\n+            addPath(policy, \"path.data\", path, \"read,readlink,write,delete\");\n         }\n         for (Path path : environment.dataWithClusterFiles()) {\n-            addPath(policy, path, \"read,readlink,write,delete\");\n+            addPath(policy, \"path.data\", path, \"read,readlink,write,delete\");\n         }\n         for (Path path : environment.repoFiles()) {\n-            addPath(policy, path, \"read,readlink,write,delete\");\n+            addPath(policy, \"path.repo\", path, \"read,readlink,write,delete\");\n         }\n         if (environment.pidFile() != null) {\n             // we just need permission to remove the file if its elsewhere.\n             policy.add(new FilePermission(environment.pidFile().toString(), \"delete\"));\n         }\n         return policy;\n     }\n\\ No newline at end of file\n",
			"extendedDetails": {}
		},
		"ff5ad39c7a5f8ea21d3ff86d3ce50668602d7a74": {
			"type": "Ybodychange",
			"commitMessage": "Add `path.shared_data`\n\nThis allows `path.shared_data` to be added to the security manager while\nstill allowing a custom `data_path` for indices using shadow replicas.\n\nFor example, configuring `path.shared_data: /tmp/foo`, then created an\nindex with:\n\n```\nPOST /myindex\n{\n  \"index\": {\n    \"number_of_shards\": 1,\n    \"number_of_replicas\": 1,\n    \"data_path\": \"/tmp/foo/bar/baz\",\n    \"shadow_replicas\": true\n  }\n}\n```\n\nThe index will then reside in `/tmp/foo/bar/baz`.\n\n`path.shared_data` defaults to `null` if not specified.\n\nResolves #12714\nRelates to #11065\n",
			"commitDate": "2015-08-12, 9:51 AM",
			"commitName": "ff5ad39c7a5f8ea21d3ff86d3ce50668602d7a74",
			"commitAuthor": "Lee Hinman",
			"commitDateOld": "2015-08-05, 3:45 AM",
			"commitNameOld": "d7d25fe6b595422c38426ed1b39ab8f93f5b5919",
			"commitAuthorOld": "Robert Muir",
			"daysBetweenCommits": 7.25,
			"commitsBetweenForRepo": 119,
			"commitsBetweenForFile": 1,
			"diff": "@@ -1,26 +1,29 @@\n     static Permissions createPermissions(Environment environment) throws IOException {\n         Permissions policy = new Permissions();\n         // read-only dirs\n         addPath(policy, environment.binFile(), \"read,readlink\");\n         addPath(policy, environment.libFile(), \"read,readlink\");\n         addPath(policy, environment.pluginsFile(), \"read,readlink\");\n         addPath(policy, environment.configFile(), \"read,readlink\");\n         addPath(policy, environment.scriptsFile(), \"read,readlink\");\n         // read-write dirs\n         addPath(policy, environment.tmpFile(), \"read,readlink,write,delete\");\n         addPath(policy, environment.logsFile(), \"read,readlink,write,delete\");\n+        if (environment.sharedDataFile() != null) {\n+            addPath(policy, environment.sharedDataFile(), \"read,readlink,write,delete\");\n+        }\n         for (Path path : environment.dataFiles()) {\n             addPath(policy, path, \"read,readlink,write,delete\");\n         }\n         for (Path path : environment.dataWithClusterFiles()) {\n             addPath(policy, path, \"read,readlink,write,delete\");\n         }\n         for (Path path : environment.repoFiles()) {\n             addPath(policy, path, \"read,readlink,write,delete\");\n         }\n         if (environment.pidFile() != null) {\n             // we just need permission to remove the file if its elsewhere.\n             policy.add(new FilePermission(environment.pidFile().toString(), \"delete\"));\n         }\n         return policy;\n     }\n\\ No newline at end of file\n",
			"extendedDetails": {}
		},
		"d7d25fe6b595422c38426ed1b39ab8f93f5b5919": {
			"type": "Ybodychange",
			"commitMessage": "Add path.scripts directory\n\nToday this is \"unofficial\" as conf/scripts, but some people\nwant to share scripts across different nodes and so on. Because\nthey cannot configure it, they are forced to use dirty hacks\nlike symbolic links, which isnt going to work: we aren't going\nto recursively scan conf/ and add permissions to all link targets\nunderneath it, thats crazy.\n\nI really hate adding yet another configuration knob here, but\nusers resorting to using symlinks are going to be frustrated,\nand do things in a more insecure way.\n",
			"commitDate": "2015-08-05, 3:45 AM",
			"commitName": "d7d25fe6b595422c38426ed1b39ab8f93f5b5919",
			"commitAuthor": "Robert Muir",
			"commitDateOld": "2015-08-03, 1:58 PM",
			"commitNameOld": "2623ce7960b1720e06ea2ea2bfaad3621f5736f7",
			"commitAuthorOld": "Robert Muir",
			"daysBetweenCommits": 1.57,
			"commitsBetweenForRepo": 38,
			"commitsBetweenForFile": 1,
			"diff": "@@ -1,25 +1,26 @@\n     static Permissions createPermissions(Environment environment) throws IOException {\n         Permissions policy = new Permissions();\n         // read-only dirs\n         addPath(policy, environment.binFile(), \"read,readlink\");\n         addPath(policy, environment.libFile(), \"read,readlink\");\n         addPath(policy, environment.pluginsFile(), \"read,readlink\");\n         addPath(policy, environment.configFile(), \"read,readlink\");\n+        addPath(policy, environment.scriptsFile(), \"read,readlink\");\n         // read-write dirs\n         addPath(policy, environment.tmpFile(), \"read,readlink,write,delete\");\n         addPath(policy, environment.logsFile(), \"read,readlink,write,delete\");\n         for (Path path : environment.dataFiles()) {\n             addPath(policy, path, \"read,readlink,write,delete\");\n         }\n         for (Path path : environment.dataWithClusterFiles()) {\n             addPath(policy, path, \"read,readlink,write,delete\");\n         }\n         for (Path path : environment.repoFiles()) {\n             addPath(policy, path, \"read,readlink,write,delete\");\n         }\n         if (environment.pidFile() != null) {\n             // we just need permission to remove the file if its elsewhere.\n             policy.add(new FilePermission(environment.pidFile().toString(), \"delete\"));\n         }\n         return policy;\n     }\n\\ No newline at end of file\n",
			"extendedDetails": {}
		},
		"2623ce7960b1720e06ea2ea2bfaad3621f5736f7": {
			"type": "Ybodychange",
			"commitMessage": "Improve permissions checking in security tests and fix crazy pidfile parent permissions\n",
			"commitDate": "2015-08-03, 1:58 PM",
			"commitName": "2623ce7960b1720e06ea2ea2bfaad3621f5736f7",
			"commitAuthor": "Robert Muir",
			"commitDateOld": "2015-08-03, 11:43 AM",
			"commitNameOld": "be6f9a0196979ed02f64134013f3c9767e1f8296",
			"commitAuthorOld": "Robert Muir",
			"daysBetweenCommits": 0.09,
			"commitsBetweenForRepo": 1,
			"commitsBetweenForFile": 1,
			"diff": "@@ -1,24 +1,25 @@\n     static Permissions createPermissions(Environment environment) throws IOException {\n         Permissions policy = new Permissions();\n         // read-only dirs\n         addPath(policy, environment.binFile(), \"read,readlink\");\n         addPath(policy, environment.libFile(), \"read,readlink\");\n         addPath(policy, environment.pluginsFile(), \"read,readlink\");\n         addPath(policy, environment.configFile(), \"read,readlink\");\n         // read-write dirs\n         addPath(policy, environment.tmpFile(), \"read,readlink,write,delete\");\n         addPath(policy, environment.logsFile(), \"read,readlink,write,delete\");\n         for (Path path : environment.dataFiles()) {\n             addPath(policy, path, \"read,readlink,write,delete\");\n         }\n         for (Path path : environment.dataWithClusterFiles()) {\n             addPath(policy, path, \"read,readlink,write,delete\");\n         }\n         for (Path path : environment.repoFiles()) {\n             addPath(policy, path, \"read,readlink,write,delete\");\n         }\n         if (environment.pidFile() != null) {\n-            addPath(policy, environment.pidFile().getParent(), \"read,readlink,write,delete\");\n+            // we just need permission to remove the file if its elsewhere.\n+            policy.add(new FilePermission(environment.pidFile().toString(), \"delete\"));\n         }\n         return policy;\n     }\n\\ No newline at end of file\n",
			"extendedDetails": {}
		},
		"be6f9a0196979ed02f64134013f3c9767e1f8296": {
			"type": "Ybodychange",
			"commitMessage": "improve sanity of securitymanager file permissions\n\nconf/ and plugins/ do not need read-write access: this prevents a lot\nof bad possibilities.\n",
			"commitDate": "2015-08-03, 11:43 AM",
			"commitName": "be6f9a0196979ed02f64134013f3c9767e1f8296",
			"commitAuthor": "Robert Muir",
			"commitDateOld": "2015-08-03, 10:20 AM",
			"commitNameOld": "e472cbed09cb6a4020a2ff4114e546abe8476252",
			"commitAuthorOld": "",
			"daysBetweenCommits": 0.06,
			"commitsBetweenForRepo": 1,
			"commitsBetweenForFile": 1,
			"diff": "@@ -1,23 +1,24 @@\n     static Permissions createPermissions(Environment environment) throws IOException {\n         Permissions policy = new Permissions();\n         // read-only dirs\n         addPath(policy, environment.binFile(), \"read,readlink\");\n         addPath(policy, environment.libFile(), \"read,readlink\");\n+        addPath(policy, environment.pluginsFile(), \"read,readlink\");\n+        addPath(policy, environment.configFile(), \"read,readlink\");\n+        // read-write dirs\n         addPath(policy, environment.tmpFile(), \"read,readlink,write,delete\");\n-        addPath(policy, environment.configFile(), \"read,readlink,write,delete\");\n         addPath(policy, environment.logsFile(), \"read,readlink,write,delete\");\n-        addPath(policy, environment.pluginsFile(), \"read,readlink,write,delete\");\n         for (Path path : environment.dataFiles()) {\n             addPath(policy, path, \"read,readlink,write,delete\");\n         }\n         for (Path path : environment.dataWithClusterFiles()) {\n             addPath(policy, path, \"read,readlink,write,delete\");\n         }\n         for (Path path : environment.repoFiles()) {\n             addPath(policy, path, \"read,readlink,write,delete\");\n         }\n         if (environment.pidFile() != null) {\n             addPath(policy, environment.pidFile().getParent(), \"read,readlink,write,delete\");\n         }\n         return policy;\n     }\n\\ No newline at end of file\n",
			"extendedDetails": {}
		},
		"052cf1446f9caea16454e0db5860e8e694c61119": {
			"type": "Ybodychange",
			"commitMessage": "Remove Environment.homeFile()\n\nToday we grant read+write+delete access to any files underneath the home.\nBut we have to remove this, if we want to have improved security of files\nunderneath elasticsearch.\n",
			"commitDate": "2015-07-20, 5:27 PM",
			"commitName": "052cf1446f9caea16454e0db5860e8e694c61119",
			"commitAuthor": "Robert Muir",
			"commitDateOld": "2015-07-07, 2:43 PM",
			"commitNameOld": "46c89f006d16e5b36dedd9ff36651ea4efa3a557",
			"commitAuthorOld": "Robert Muir",
			"daysBetweenCommits": 13.11,
			"commitsBetweenForRepo": 206,
			"commitsBetweenForFile": 1,
			"diff": "@@ -1,23 +1,23 @@\n     static Permissions createPermissions(Environment environment) throws IOException {\n-        // TODO: improve test infra so we can reduce permissions where read/write\n-        // is not really needed...\n         Permissions policy = new Permissions();\n+        // read-only dirs\n+        addPath(policy, environment.binFile(), \"read,readlink\");\n+        addPath(policy, environment.libFile(), \"read,readlink\");\n         addPath(policy, environment.tmpFile(), \"read,readlink,write,delete\");\n-        addPath(policy, environment.homeFile(), \"read,readlink,write,delete\");\n         addPath(policy, environment.configFile(), \"read,readlink,write,delete\");\n         addPath(policy, environment.logsFile(), \"read,readlink,write,delete\");\n         addPath(policy, environment.pluginsFile(), \"read,readlink,write,delete\");\n         for (Path path : environment.dataFiles()) {\n             addPath(policy, path, \"read,readlink,write,delete\");\n         }\n         for (Path path : environment.dataWithClusterFiles()) {\n             addPath(policy, path, \"read,readlink,write,delete\");\n         }\n         for (Path path : environment.repoFiles()) {\n             addPath(policy, path, \"read,readlink,write,delete\");\n         }\n         if (environment.pidFile() != null) {\n             addPath(policy, environment.pidFile().getParent(), \"read,readlink,write,delete\");\n         }\n         return policy;\n     }\n\\ No newline at end of file\n",
			"extendedDetails": {}
		},
		"15a62448343fd24f8e63f43b1e4b16f50005e4a5": {
			"type": "Yfilerename",
			"commitMessage": "create core module\n",
			"commitDate": "2015-06-05, 4:12 AM",
			"commitName": "15a62448343fd24f8e63f43b1e4b16f50005e4a5",
			"commitAuthor": "Simon Willnauer",
			"commitDateOld": "2015-06-05, 4:11 AM",
			"commitNameOld": "7ccc193a666e2ae888e7ac93d677a2143e5e07c3",
			"commitAuthorOld": "Simon Willnauer",
			"daysBetweenCommits": 0,
			"commitsBetweenForRepo": 1,
			"commitsBetweenForFile": 1,
			"diff": "",
			"extendedDetails": {
				"oldPath": "src/main/java/org/elasticsearch/bootstrap/Security.java",
				"newPath": "core/src/main/java/org/elasticsearch/bootstrap/Security.java"
			}
		},
		"dd41c68741a6f2f8c296f41dcf58e2a6ae6b29b1": {
			"type": "Ybodychange",
			"commitMessage": "Snapshot/Restore: fix FSRepository location configuration\n\nCloses #11068\n",
			"commitDate": "2015-05-20, 7:14 PM",
			"commitName": "dd41c68741a6f2f8c296f41dcf58e2a6ae6b29b1",
			"commitAuthor": "Igor Motov",
			"commitDateOld": "2015-05-11, 9:34 PM",
			"commitNameOld": "019a9410a355f085b28a03ef623a0cb5c9ab06b3",
			"commitAuthorOld": "Robert Muir",
			"daysBetweenCommits": 8.9,
			"commitsBetweenForRepo": 152,
			"commitsBetweenForFile": 1,
			"diff": "@@ -1,20 +1,23 @@\n     static Permissions createPermissions(Environment environment) throws IOException {\n         // TODO: improve test infra so we can reduce permissions where read/write\n         // is not really needed...\n         Permissions policy = new Permissions();\n         addPath(policy, environment.tmpFile(), \"read,readlink,write,delete\");\n         addPath(policy, environment.homeFile(), \"read,readlink,write,delete\");\n         addPath(policy, environment.configFile(), \"read,readlink,write,delete\");\n         addPath(policy, environment.logsFile(), \"read,readlink,write,delete\");\n         addPath(policy, environment.pluginsFile(), \"read,readlink,write,delete\");\n         for (Path path : environment.dataFiles()) {\n             addPath(policy, path, \"read,readlink,write,delete\");\n         }\n         for (Path path : environment.dataWithClusterFiles()) {\n             addPath(policy, path, \"read,readlink,write,delete\");\n         }\n+        for (Path path : environment.repoFiles()) {\n+            addPath(policy, path, \"read,readlink,write,delete\");\n+        }\n         if (environment.pidFile() != null) {\n             addPath(policy, environment.pidFile().getParent(), \"read,readlink,write,delete\");\n         }\n         return policy;\n     }\n\\ No newline at end of file\n",
			"extendedDetails": {}
		},
		"51c71c235b1701bd5c25de91c53fa27d0894033f": {
			"type": "Ybodychange",
			"commitMessage": "Ban PathUtils.get (for now, until we fix the two remaining issues)\n",
			"commitDate": "2015-05-08, 11:42 AM",
			"commitName": "51c71c235b1701bd5c25de91c53fa27d0894033f",
			"commitAuthor": "Robert Muir",
			"commitDateOld": "2015-05-05, 9:39 AM",
			"commitNameOld": "3976724882ed19e51eec9fd835a443ecfc42688c",
			"commitAuthorOld": "Tanguy Leroux",
			"daysBetweenCommits": 3.09,
			"commitsBetweenForRepo": 35,
			"commitsBetweenForFile": 1,
			"diff": "@@ -1,20 +1,20 @@\n     static Permissions createPermissions(Environment environment) throws IOException {\n         // TODO: improve test infra so we can reduce permissions where read/write\n         // is not really needed...\n         Permissions policy = new Permissions();\n-        addPath(policy, PathUtils.get(System.getProperty(\"java.io.tmpdir\")), \"read,readlink,write,delete\");\n+        addPath(policy, environment.tmpFile(), \"read,readlink,write,delete\");\n         addPath(policy, environment.homeFile(), \"read,readlink,write,delete\");\n         addPath(policy, environment.configFile(), \"read,readlink,write,delete\");\n         addPath(policy, environment.logsFile(), \"read,readlink,write,delete\");\n         addPath(policy, environment.pluginsFile(), \"read,readlink,write,delete\");\n         for (Path path : environment.dataFiles()) {\n             addPath(policy, path, \"read,readlink,write,delete\");\n         }\n         for (Path path : environment.dataWithClusterFiles()) {\n             addPath(policy, path, \"read,readlink,write,delete\");\n         }\n         if (environment.pidFile() != null) {\n             addPath(policy, environment.pidFile().getParent(), \"read,readlink,write,delete\");\n         }\n         return policy;\n     }\n\\ No newline at end of file\n",
			"extendedDetails": {}
		},
		"3976724882ed19e51eec9fd835a443ecfc42688c": {
			"type": "Ybodychange",
			"commitMessage": "Add pid file to Environment\n\nThis commit adds the path of the PID file to the Environment. It also add it to the Security Manager since the PID file is deleted by a shutdown hook when the JVM is exited.\n",
			"commitDate": "2015-05-05, 9:39 AM",
			"commitName": "3976724882ed19e51eec9fd835a443ecfc42688c",
			"commitAuthor": "Tanguy Leroux",
			"commitDateOld": "2015-05-04, 3:28 PM",
			"commitNameOld": "b889b3b437fd8a124ad8691d878d18339f20425b",
			"commitAuthorOld": "Ryan Ernst",
			"daysBetweenCommits": 0.76,
			"commitsBetweenForRepo": 14,
			"commitsBetweenForFile": 1,
			"diff": "@@ -1,18 +1,20 @@\n     static Permissions createPermissions(Environment environment) throws IOException {\n         // TODO: improve test infra so we can reduce permissions where read/write\n         // is not really needed...\n         Permissions policy = new Permissions();\n         addPath(policy, PathUtils.get(System.getProperty(\"java.io.tmpdir\")), \"read,readlink,write,delete\");\n         addPath(policy, environment.homeFile(), \"read,readlink,write,delete\");\n         addPath(policy, environment.configFile(), \"read,readlink,write,delete\");\n         addPath(policy, environment.logsFile(), \"read,readlink,write,delete\");\n         addPath(policy, environment.pluginsFile(), \"read,readlink,write,delete\");\n         for (Path path : environment.dataFiles()) {\n             addPath(policy, path, \"read,readlink,write,delete\");\n         }\n         for (Path path : environment.dataWithClusterFiles()) {\n             addPath(policy, path, \"read,readlink,write,delete\");\n         }\n-\n+        if (environment.pidFile() != null) {\n+            addPath(policy, environment.pidFile().getParent(), \"read,readlink,write,delete\");\n+        }\n         return policy;\n     }\n\\ No newline at end of file\n",
			"extendedDetails": {}
		},
		"b889b3b437fd8a124ad8691d878d18339f20425b": {
			"type": "Ymultichange(Yparameterchange,Ybodychange)",
			"commitMessage": "Use java sys prop override in tests instead of flag to createPermissions\n",
			"commitDate": "2015-05-04, 3:28 PM",
			"commitName": "b889b3b437fd8a124ad8691d878d18339f20425b",
			"commitAuthor": "Ryan Ernst",
			"subchanges": [
				{
					"type": "Yparameterchange",
					"commitMessage": "Use java sys prop override in tests instead of flag to createPermissions\n",
					"commitDate": "2015-05-04, 3:28 PM",
					"commitName": "b889b3b437fd8a124ad8691d878d18339f20425b",
					"commitAuthor": "Ryan Ernst",
					"commitDateOld": "2015-05-04, 1:27 PM",
					"commitNameOld": "2ed2c4f884f01e51adf396aac3496bcc0a8f14c8",
					"commitAuthorOld": "Robert Muir",
					"daysBetweenCommits": 0.08,
					"commitsBetweenForRepo": 3,
					"commitsBetweenForFile": 1,
					"diff": "@@ -1,20 +1,18 @@\n-    static Permissions createPermissions(Environment environment, boolean addTempDir) throws IOException {\n+    static Permissions createPermissions(Environment environment) throws IOException {\n         // TODO: improve test infra so we can reduce permissions where read/write\n         // is not really needed...\n         Permissions policy = new Permissions();\n-        if (addTempDir) {\n-            addPath(policy, PathUtils.get(System.getProperty(\"java.io.tmpdir\")), \"read,readlink,write,delete\");\n-        }\n+        addPath(policy, PathUtils.get(System.getProperty(\"java.io.tmpdir\")), \"read,readlink,write,delete\");\n         addPath(policy, environment.homeFile(), \"read,readlink,write,delete\");\n         addPath(policy, environment.configFile(), \"read,readlink,write,delete\");\n         addPath(policy, environment.logsFile(), \"read,readlink,write,delete\");\n         addPath(policy, environment.pluginsFile(), \"read,readlink,write,delete\");\n         for (Path path : environment.dataFiles()) {\n             addPath(policy, path, \"read,readlink,write,delete\");\n         }\n         for (Path path : environment.dataWithClusterFiles()) {\n             addPath(policy, path, \"read,readlink,write,delete\");\n         }\n \n         return policy;\n     }\n\\ No newline at end of file\n",
					"extendedDetails": {
						"oldValue": "[environment-Environment, addTempDir-boolean]",
						"newValue": "[environment-Environment]"
					}
				},
				{
					"type": "Ybodychange",
					"commitMessage": "Use java sys prop override in tests instead of flag to createPermissions\n",
					"commitDate": "2015-05-04, 3:28 PM",
					"commitName": "b889b3b437fd8a124ad8691d878d18339f20425b",
					"commitAuthor": "Ryan Ernst",
					"commitDateOld": "2015-05-04, 1:27 PM",
					"commitNameOld": "2ed2c4f884f01e51adf396aac3496bcc0a8f14c8",
					"commitAuthorOld": "Robert Muir",
					"daysBetweenCommits": 0.08,
					"commitsBetweenForRepo": 3,
					"commitsBetweenForFile": 1,
					"diff": "@@ -1,20 +1,18 @@\n-    static Permissions createPermissions(Environment environment, boolean addTempDir) throws IOException {\n+    static Permissions createPermissions(Environment environment) throws IOException {\n         // TODO: improve test infra so we can reduce permissions where read/write\n         // is not really needed...\n         Permissions policy = new Permissions();\n-        if (addTempDir) {\n-            addPath(policy, PathUtils.get(System.getProperty(\"java.io.tmpdir\")), \"read,readlink,write,delete\");\n-        }\n+        addPath(policy, PathUtils.get(System.getProperty(\"java.io.tmpdir\")), \"read,readlink,write,delete\");\n         addPath(policy, environment.homeFile(), \"read,readlink,write,delete\");\n         addPath(policy, environment.configFile(), \"read,readlink,write,delete\");\n         addPath(policy, environment.logsFile(), \"read,readlink,write,delete\");\n         addPath(policy, environment.pluginsFile(), \"read,readlink,write,delete\");\n         for (Path path : environment.dataFiles()) {\n             addPath(policy, path, \"read,readlink,write,delete\");\n         }\n         for (Path path : environment.dataWithClusterFiles()) {\n             addPath(policy, path, \"read,readlink,write,delete\");\n         }\n \n         return policy;\n     }\n\\ No newline at end of file\n",
					"extendedDetails": {}
				}
			]
		},
		"2ed2c4f884f01e51adf396aac3496bcc0a8f14c8": {
			"type": "Ymultichange(Yparameterchange,Ybodychange)",
			"commitMessage": "fix permissions bugs\n",
			"commitDate": "2015-05-04, 1:27 PM",
			"commitName": "2ed2c4f884f01e51adf396aac3496bcc0a8f14c8",
			"commitAuthor": "Robert Muir",
			"subchanges": [
				{
					"type": "Yparameterchange",
					"commitMessage": "fix permissions bugs\n",
					"commitDate": "2015-05-04, 1:27 PM",
					"commitName": "2ed2c4f884f01e51adf396aac3496bcc0a8f14c8",
					"commitAuthor": "Robert Muir",
					"commitDateOld": "2015-05-04, 12:38 PM",
					"commitNameOld": "fe046df12589dd4477637f26c0ca255d70aba169",
					"commitAuthorOld": "Robert Muir",
					"daysBetweenCommits": 0.03,
					"commitsBetweenForRepo": 1,
					"commitsBetweenForFile": 1,
					"diff": "@@ -1,17 +1,20 @@\n-    static Permissions createPermissions(Environment environment) throws IOException {\n+    static Permissions createPermissions(Environment environment, boolean addTempDir) throws IOException {\n         // TODO: improve test infra so we can reduce permissions where read/write\n         // is not really needed...\n         Permissions policy = new Permissions();\n+        if (addTempDir) {\n+            addPath(policy, PathUtils.get(System.getProperty(\"java.io.tmpdir\")), \"read,readlink,write,delete\");\n+        }\n         addPath(policy, environment.homeFile(), \"read,readlink,write,delete\");\n         addPath(policy, environment.configFile(), \"read,readlink,write,delete\");\n         addPath(policy, environment.logsFile(), \"read,readlink,write,delete\");\n         addPath(policy, environment.pluginsFile(), \"read,readlink,write,delete\");\n         for (Path path : environment.dataFiles()) {\n             addPath(policy, path, \"read,readlink,write,delete\");\n         }\n         for (Path path : environment.dataWithClusterFiles()) {\n             addPath(policy, path, \"read,readlink,write,delete\");\n         }\n \n         return policy;\n     }\n\\ No newline at end of file\n",
					"extendedDetails": {
						"oldValue": "[environment-Environment]",
						"newValue": "[environment-Environment, addTempDir-boolean]"
					}
				},
				{
					"type": "Ybodychange",
					"commitMessage": "fix permissions bugs\n",
					"commitDate": "2015-05-04, 1:27 PM",
					"commitName": "2ed2c4f884f01e51adf396aac3496bcc0a8f14c8",
					"commitAuthor": "Robert Muir",
					"commitDateOld": "2015-05-04, 12:38 PM",
					"commitNameOld": "fe046df12589dd4477637f26c0ca255d70aba169",
					"commitAuthorOld": "Robert Muir",
					"daysBetweenCommits": 0.03,
					"commitsBetweenForRepo": 1,
					"commitsBetweenForFile": 1,
					"diff": "@@ -1,17 +1,20 @@\n-    static Permissions createPermissions(Environment environment) throws IOException {\n+    static Permissions createPermissions(Environment environment, boolean addTempDir) throws IOException {\n         // TODO: improve test infra so we can reduce permissions where read/write\n         // is not really needed...\n         Permissions policy = new Permissions();\n+        if (addTempDir) {\n+            addPath(policy, PathUtils.get(System.getProperty(\"java.io.tmpdir\")), \"read,readlink,write,delete\");\n+        }\n         addPath(policy, environment.homeFile(), \"read,readlink,write,delete\");\n         addPath(policy, environment.configFile(), \"read,readlink,write,delete\");\n         addPath(policy, environment.logsFile(), \"read,readlink,write,delete\");\n         addPath(policy, environment.pluginsFile(), \"read,readlink,write,delete\");\n         for (Path path : environment.dataFiles()) {\n             addPath(policy, path, \"read,readlink,write,delete\");\n         }\n         for (Path path : environment.dataWithClusterFiles()) {\n             addPath(policy, path, \"read,readlink,write,delete\");\n         }\n \n         return policy;\n     }\n\\ No newline at end of file\n",
					"extendedDetails": {}
				}
			]
		},
		"86fc8ceac71fbcfe95d6675eeb6b2ffc2cb71d41": {
			"type": "Yintroduced",
			"commitMessage": "simplify security rules\n",
			"commitDate": "2015-05-02, 11:42 AM",
			"commitName": "86fc8ceac71fbcfe95d6675eeb6b2ffc2cb71d41",
			"commitAuthor": "Robert Muir",
			"diff": "@@ -0,0 +1,17 @@\n+    static Permissions createPermissions(Environment environment) throws IOException {\n+        // TODO: improve test infra so we can reduce permissions where read/write\n+        // is not really needed...\n+        Permissions policy = new Permissions();\n+        addPath(policy, environment.homeFile(), \"read,readlink,write,delete\");\n+        addPath(policy, environment.configFile(), \"read,readlink,write,delete\");\n+        addPath(policy, environment.logsFile(), \"read,readlink,write,delete\");\n+        addPath(policy, environment.pluginsFile(), \"read,readlink,write,delete\");\n+        for (Path path : environment.dataFiles()) {\n+            addPath(policy, path, \"read,readlink,write,delete\");\n+        }\n+        for (Path path : environment.dataWithClusterFiles()) {\n+            addPath(policy, path, \"read,readlink,write,delete\");\n+        }\n+\n+        return policy;\n+    }\n\\ No newline at end of file\n"
		}
	},
	"sha": "767c69593c67befb843686de8ea51b7bc87728c9"
}